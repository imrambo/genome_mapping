Author: Ian Rambo
ian.rambo@utexas.edu
v.1.0.0.1

Reproducible read mapping builds with SCons.

This wrapper maps FASTQ reads against an assembly (e.g. genome) in FASTA format using BWA-MEM.
This script will pair up groups of FASTQ files and map them to an assembly.

This script is intended to ensure you:
1) can reproduce large mapping runs
2) do not repeat completed steps that might take a long time
3) do not produce huge intermediate files (e.g. unfiltered SAM)

###############
Getting Started
###############
Cloning from the GitHub repository


git clone


Prerequisites: conda, python=3.5, bwa, samtools=1.8, biopython, python-magic
bwa, samtools=1.8

I recommend using a conda environment (either with Miniconda3 or Anaconda) to run this script. You can create the
conda environment using the conda_config.sh script:

bash conda_config.sh <YOUR ENV NAME>

conda activate <YOUR ENV NAME>

Or

envName=<YOUR ENV NAME>
conda create -n $envName python=3.5 && \
conda install -c conda-forge -n $envName python-magic && \
conda install -c conda-forge -n $envName scons && \
conda install -c bioconda -n $envName samtools=1.8 bwa

###############
Running the script
###############
To see the available options for SCons, as well as the local options for the mapping, run this in the
same directory as the SConstruct file:

scons -h

Inputs:
--assembly=<a nucleotide FASTA to map reads to>
--sampleids=<sample id patterns of gzipped FASTQ files. Currently,
    files must be gzip compressed. The pattern is searched using a BASH-like glob.
    For FOO.fastq.gz, just pass FOO for this option.
    For multiple files, e.g. FOO.fastq.gz and BAR.fastq.gz, pass:
    FOO,BAR>

The script must be run from the same directory as the SConstruct.

cd /path/to/genome_mapping

Be sure to use all of these included options:
scons --fastq_dir=<path to directory containing fastq files> --assembly=<path to assembly you are mapping to> --outdir=<output directory> --sampleids=<sample id patterns of FASTQ files> --align_thread=<threads for BWA-mem> --samsort_thread=<theads for samtools sort> --samsort_mem=<memory per thread for samtools sort. Specify number and G,M,K> --nslice=<number of FASTQ headers to use for interleave check. Must be >4> --tmpdir=<directory for temporary files>

Note that for SCons, the options must not have spaces between the values and names.

By default, SCons will create a build in the same directory as the SConstruct.
Include the --rm_local_build option to delete this build.
